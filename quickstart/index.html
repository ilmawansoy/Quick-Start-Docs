<html>
    <head>
        <title>Kata Docs</title>
        <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="../css/style.css">
        <link rel="stylesheet" href="../css/kata.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.1/css/materialize.min.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    </head>
    
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>
    
    <div class="navbar-fixed">
        <nav class="nav-style">
            <div class="nav-wrapper container">
                
<ul class="left">
    <li>
        <h4 class="brand">KataDocs</h4>
    </li>
    
    
    <li class="">
        <a href="..">Home</a>
    </li>
    
    
    
    <li class="current">
        <a href="./">Quick Start</a>
    </li>
    
    
</ul>


<ul class="right">
    
    <li >
        <a rel="next" href="..">
            <i class="fa fa-arrow-left"></i>  Previous 
        </a>
    </li>
    <li class="disabled">
        <a rel="prev" >
            Next  <i class="fa fa-arrow-right"></i>
        </a>
    </li>
        
</ul>    
            </div>
        </nav>    
    </div>
    
    <body>
        <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
        <script type="text/javascript" src="../js/materialize.min.js"></script>
        <script type="text/javascript" src="../js/base.js"></script>
        <script type="text/javascript" src="../js/script.js"></script>
        <div class="container">
          <div class="row">
            <div class="sidenavbar col s3 m3">
              <div class="bs-sidebar hidden-print affix well" role="complementary" id="scrollbar-style">
    <ul class="nav bs-sidenav">
    
        <li class="first-level active"><a href="#quick-start">Quick Start</a></li>
        
            <li class="second-level"><a href="#hello-bot">Hello Bot</a></li>
            
                <li class="third-level"><a href="#init-project">Init project</a></li>
            
                <li class="third-level"><a href="#writing-flow">Writing Flow</a></li>
            
                <li class="third-level"><a href="#push-your-bot">Push your Bot</a></li>
            
                <li class="third-level"><a href="#deployment">Deployment</a></li>
            
                <li class="third-level"><a href="#adding-channel">Adding Channel</a></li>
            
                <li class="third-level"><a href="#adding-webhook">Adding webhook</a></li>
            
        
            <li class="second-level"><a href="#example-create-and-setup-bot-official-account-line">Example: Create and Setup Bot Official Account (LINE)</a></li>
            
        
    
    </ul>
</div>
            </div>  
            <div class="col s9 m9 main-content">
                

<h1 id="quick-start">Quick Start</h1>
<h2 id="hello-bot">Hello Bot</h2>
<p>Before started
<strong>Simple explanation about the fundamental components of the bot consists of:</strong></p>
<ul>
<li><span> nlu's </span>: the natural language understanding/model, defined to be used in the bot</li>
<li><span> intents </span> : is list of purpose defined to understand user intention</li>
<li><span> states </span> : is the stages/procedure of interaction with user</li>
<li><span> actions </span> : is list of action defined to perform in each state </li>
<li><span> methods </span> : case of more complicated computation/action needed. In javascript language</li>
</ul>
<h3 id="init-project">Init project</h3>
<p>Create folder for your bot project, and init your bot there.</p>
<pre><code>$ mkdir &lt;bot-folder&gt;
$ cd &lt;bot-folder&gt;
$ kata init &lt;bot-id&gt; &lt;bot-name&gt; [version]
</code></pre>

<p>Note: login not required to init bot</p>
<p>this will generate folder with <strong>nlu.yml, bot.yml, message.yml, flows folder</strong>
example:</p>
<pre><code>schema: kata.ai/schema/kata-ml/1.0
name: &lt;bot-name&gt;
desc: Bot Description
version: &lt;bot-version&gt; #example 0.0.1
flows:
    fallback: $include(./flows/fallback.yml)
config:
    messages: $include(./messages.yml)
    maxRecursion: 10
nlus: $include(./nlu.yml)
id: &lt;bot-id&gt;
</code></pre>

<h3 id="writing-flow">Writing Flow</h3>
<p>Modify <strong>nlu.yml</strong>, to add handler for the next intent</p>
<pre><code>confidenceLevel:
    type: method
    method: confidenceLevel

# nlu greet will define input keyword hello, hallo, hai, and hi as hello
greet:
    type: keyword
    options:
        keywords:
            hello:
                - hello
                - hallo
                - hai
                - hi
</code></pre>

<p>Modify intents at <strong>flow/fallback.yml</strong>. 
Make 'hi' intents to use nlu 'greet' instead.</p>
<pre><code>hi:
    initial: true
    type: text
    classifier:
        nlu: greet
</code></pre>

<p><strong>Flow Explanation</strong></p>
<ul>
<li>Intent will have value of 'hi' if input is caught by 'greet' NLU, and 'dunno' if no other intent caught by its classifier ('fallback: true' is like the default)</li>
<li>After going to intents, next step is to go to states which have the value 'initial: true'.</li>
<li>Case the input caught by 'hi' intents ('hello', hallo, etc).
    'sayHi' transitions condition will be fulfilled, then at 'sayHi' transitions 'sayHi' actions will give text output from messages.yml with templates/sayHi's value</li>
<li>Case the input not caught by any intent (will have 'dunno' as its intents).
    'sorry' transitions condition as the default transitions from 'init' will be fulfilled, then at 'sorry' transitions 'saySorry' actions will give text output from messages.yml with templates/saySorry's value</li>
</ul>
<h3 id="push-your-bot">Push your Bot</h3>
<pre><code>$ kata push --rev &lt;patch | minor | major&gt;
</code></pre>

<h3 id="deployment">Deployment</h3>
<pre><code>$ kata deploy &lt;bot-name&gt; [version]
</code></pre>

<p>NOTE: Repeat push and deployment each time you want to update your bot at the messaging application</p>
<h3 id="adding-channel">Adding Channel</h3>
<p><span>Important:</span> This section and <a href="#example-create-and-setup-bot-official-account-line">Setup Bot</a>
are related.</p>
<pre><code>$ kata add-channel [options] &lt;bot-name&gt; &lt;channelName&gt; : ChannelId
type: &lt;line | fbmessenger&gt;
token: &lt;channel access token&gt; # given from the chat platform
refreshToken : [refresToken] # may empty
secret: &lt;channel secret&gt;
url: &lt;url&gt; # Example: 'https://api.line.me' for LINE
</code></pre>

<p>Example</p>
<pre><code>$ kata add-channel botName botChannel
</code></pre>

<p><strong>NOTE:</strong> </p>
<ul>
<li>adding channel required at least ONCE</li>
<li>channelName can be anything (to differentiate channels)</li>
</ul>
<h3 id="adding-webhook">Adding webhook</h3>
<p>Setup webhook into url:</p>
<pre><code>https://kanal.kata.ai/receive_message/{channelId}
</code></pre>

<p>NOTE: channelId generated from kata deployment-addChannel</p>
<p>Example
<img class="thumbnailImg" src="../img/6.png" alt="Image"></p>
<h2 id="example-create-and-setup-bot-official-account-line">Example: Create and Setup Bot Official Account (LINE)</h2>
<p><strong>Step:</strong></p>
<ol>
<li>Open Line Business web page</li>
<li>Choose Messaging API, Start Using Developer Trial</li>
<li>Fill required information</li>
<li>Enable API</li>
<li>Choose Settings â†’ Bot Settings, Allow use webhooks and open LINE Developers</li>
<li>Don't forget to add Webhook URL</li>
</ol>
<p>Example</p>
<p><img class="thumbnailImg" src="../img/7.png" alt="Image"></p>
<p><span>Important: </span>This bot information is needed in <a href="#adding-channel">Setup/Adding Channel</a></p>
<!-- # Pizza Bot (LINE)

Before continue into this section, please finish the <a href="#hello-bot">Hello Bot</a> section first. 

## Step 1: Differentiate greet, and can't understand input

### Step 1.1: Defining nlu

add this in **nlu.yml**


wzxhzdk:9


### Step 1.2: Defining flows

Modify *fallback.yml*


wzxhzdk:10


Create *welcome.yml*


wzxhzdk:11


Modify bot.yml


wzxhzdk:12


Now your bot able to tell if user is greeting, bot will response that it doesn't understand if user input anything other than greeting.

## Step 2: Bot can understand user's order

Add nlu at *nlu.yml.*


wzxhzdk:13


now create **order.yml **inside folder flows


wzxhzdk:14


dont forget to modify flows in **bot.yml**


wzxhzdk:15


Now the bot can have this following of conversation:


wzxhzdk:16


<img src="../img/1.png" alt="Image">

## Step 3: Modify the text menu into carousel

now modify **order.yml** by adding pizzaOptions in actions


wzxhzdk:17

Now it should show carousel of menu instead of only text.

### Step 3.1: Use the input from carousel.

New intent needed to be able to catch input from carousel. Which the type is data, and payload content used to identify which carousel is being used (in case if there are more than 1 carousel or other input categorized as type data).


Add intents at *order.yml.*


wzxhzdk:18


Add intents at *welcome.yml*


wzxhzdk:19


remove the greet state and modify the init state


wzxhzdk:20


Modify *init *states and add 2 other states at *order.yml.*


wzxhzdk:21


Add actions di *order.yml.*


wzxhzdk:22


The bot can now understand the user input from carousel. **payload** is temporary, after some transitions it will have no value stored. later on we need to assign it to a **context**
<img src="../img/2.png" alt="Image">

## Step 4: Add flow until confirmation of the the order

Two state is added in this step, to know how many pizza that the user want to order and confirm if the user already order the right one. After confirmation the state will come back to initial state so the user can start order again.

Add nlu at *nlu.yml*


wzxhzdk:23


Add intents at *order.yml*


wzxhzdk:24


Add and restructure the states in order.yml


wzxhzdk:25


Add and modify actions at order.yml too


wzxhzdk:26

<img src="../img/3.png" alt="Image">

## Step 5: Modify confirmation answer to button

modify the **order.yml** by adding the yesNoButton in actions


wzxhzdk:27


### Step 5.1: Use the input From Button

Add intent at *order.yml*


wzxhzdk:28


modify the **confirmPizza** and **init** state


wzxhzdk:29


after confirmation, at confirmPizza state it will return to init state and ready for another 'pesan' command.
<img src="../img/4.png" alt="Image">
## Step 6: Using LINE Sticker as bot response

In this step we want the bot to be able to give response to user with sticker, to identify what sticker will be used the packageId and stickerId is needed as argument in actions.

add action in **order.yml**


wzxhzdk:30


modify init state in **order.yml**


wzxhzdk:31


<img src="../img/5.png" alt="Image">
## Step 7: Using more dynamic carousel

In this step we want to create carousel but not each content is written specifically by developer, instead we can use JSON Object as its input.

Create methods in **order.yml** to simulate carousel which use JSON Object as input. The JSON Object example will be saved at *context.arr* when transit called *jalaninArr* method.


wzxhzdk:32


In state *init* at **order.yml**, add *transit *so there will be *context* which contain JSON Object example


wzxhzdk:33


Add *actions *at **order.yml**, dynamic carousel actions which use JSON Object from methods *jalaninArr*


wzxhzdk:34


In state *showPizza *at **order.yml**, change action from *pizzaOptions *to *pizzaOptionsDynamic*


wzxhzdk:35


 -->
                <br><hr>
                <p class="center">Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
            </div>
          </div>
        </div>
    </body>


</html>